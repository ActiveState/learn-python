# Python application example with ActiveState Platform

trigger:
- activestate-platform-and-state-tool-setup
jobs:
- job: Linux
  pool:
    vmImage: 'ubuntu-latest'
  steps:
  - script: sh <(curl -q https://platform.activestate.com/dl/cli/install.sh) -n
    displayName: 'Install State Tool'
  - script: state deploy MyOrg/learn-python
    displayName: 'Deploy project'
  - script: pylint src
    displayName: 'Lint with pylint'
  - script: flake8 src --statistics --count
    displayName: 'Lint with flake8'
  - script: pytest
    displayName: 'Test with pytest'
- job: macOS
  pool:
    vmImage: 'macOS-latest'
  steps:
  - script: sh <(curl -q https://platform.activestate.com/dl/cli/install.sh) -n
    displayName: 'Install State Tool'
  - script: |
      echo $AGENT_TOOLSDIRECTORY
      export PATH=$AGENT_TOOLSDIRECTORY/bin:$PATH 
      echo $PATH
      state deploy MyOrg/learn-python --path $AGENT_TOOLSDIRECTORY
    displayName: 'Deploy project'
  - script: pylint src
    displayName: 'Lint with pylint'
  - script: flake8 src --statistics --count
    displayName: 'Lint with flake8'
  - script: pytest
    displayName: 'Test with pytest'
- job: Windows
  pool:
    vmImage: 'windows-latest'
  steps:
  - powershell: sh <(curl -q https://platform.activestate.com/dl/cli/install.sh) -n
    displayName: 'Install State Tool'
  - cmd: state deploy MyOrg/learn-python
    displayName: 'Deploy project'
  - cmd: pylint src
    displayName: 'Lint with pylint'
  - cmd: flake8 src --statistics --count
    displayName: 'Lint with flake8'
  - cmd: pytest
    displayName: 'Test with pytest'
